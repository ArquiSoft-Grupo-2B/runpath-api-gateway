#!/bin/bash

echo -e "Testing token validation policy with ip endpoint...\n"

RESPONSE_NO_TOKEN=$(curl -H "Authorization: Bearer " http://localhost:8888/ip)
echo -e "Response without token:\n$RESPONSE_NO_TOKEN\n"

TOKEN="eyJhbGciOiJSUzI1NiIsImtpZCI6IjlkMjEzMGZlZjAyNTg3ZmQ4ODYxODg2OTgyMjczNGVmNzZhMTExNjUiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiZWplbXBsbyIsImlzcyI6Imh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlLmNvbS9hcnF1aXNvZnQtMmIiLCJhdWQiOiJhcnF1aXNvZnQtMmIiLCJhdXRoX3RpbWUiOjE3NjA5MjE3OTYsInVzZXJfaWQiOiJncU5Ud05qTzZHVGo2Um1vMlVFZWZqYlBLMUozIiwic3ViIjoiZ3FOVHdOak82R1RqNlJtbzJVRWVmamJQSzFKMyIsImlhdCI6MTc2MDkyMTc5NiwiZXhwIjoxNzYwOTI1Mzk2LCJlbWFpbCI6InVzZXJfZXhAZXhhbXBsZS5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsidXNlcl9leEBleGFtcGxlLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.BK4NNHnzh5N-7eZ_VDeut8hZIehceZSQXk71fSPttNehkaq886ySbbFug8opiO7NSYc-PbmXqWc9aY8nUYCHVYwN771N4t5atrT-1NRYBUNmKtMwFZJkaq4wOZCF210Eq39vUCdSqf3kjH76FBOKVKH9b4ytgVITsq8wj1Ex3qoUXmu7U9rupXFQB-cK3zZ9l4xQCaV2gHaB35pWp_e4jrRjIikpI2rTD6B172BstuT9JEk6QtSG-MGA7z_MlMqIfw31Nw29YRXN9Q6vT6_ypeBl-VCdEKF9qKF4w3RkoZYD6L4PVSI_EArsfc805NJa2Pf_rc68u-8emgrDyiRVJg"
RESPONSE_WITH_TOKEN=$(curl -H "Authorization: Bearer $TOKEN" http://localhost:8888/ip)

echo -e "Response with token:\n$RESPONSE_WITH_TOKEN\n"